# Support Vector Machine (SVM) 핵심 원리 정리

---

## 1. 점과 초평면(Hyperplane) 사이의 거리

SVM을 이해하기 위한 가장 기초적인 개념은 한 점($\mathbf{x}$)에서 초평면(hyperplane)까지의 거리를 구하는 것입니다.

-   **초평면의 방정식**: $f(\mathbf{x}) = \mathbf{w}^T \mathbf{x} + w_0 = 0$
-   **점과 초평면의 거리 공식**:
    $$\text{Distance} = \frac{|\mathbf{w}^T \mathbf{x} + w_0|}{\|\mathbf{w}\|} = \frac{|f(\mathbf{x})|}{\|\mathbf{w}\|}$$
이 거리가 바로 SVM의 **마진(Margin)**을 계산하는 기반이 됩니다.

---

## 2. 마진(Margin)의 정의와 SVM의 목표

SVM은 두 클래스 사이의 간격, 즉 마진을 최대화하는 것을 목표로 합니다.

### 기하학적 마진 (Geometric Margin)

어떤 결정 경계가 주어졌을 때, 그 경계와 모든 데이터 포인트 사이의 거리를 계산할 수 있습니다. 이 중 **가장 짧은 거리**가 바로 그 경계의 **기하학적 마진**입니다.

$$ \text{Margin} = \min_{i} \frac{|f(\mathbf{x}^{(i)})|}{||\mathbf{w}||} $$

이 최소 거리를 결정하는, 경계에 가장 가까이 있는 데이터 포인트를 **서포트 벡터(Support Vector)**라고 부릅니다. 이름에서 알 수 있듯이, 이 벡터들이 마진 경계를 '지지'하는 역할을 합니다.

### SVM의 목표: Max-Min 원리

SVM의 최종 목표는 수많은 가능한 결정 경계 중에서, 위에서 정의한 **기하학적 마진을 최대화(Maximize)**하는 최적의 경계를 찾는 것입니다.

> "모든 점들과의 거리 중 **최소값(min)**이 **최대(max)**가 되는 경계를 찾아라."



---

## 3. 문제 단순화를 위한 수학적 트릭: 스케일링

위의 `max-min` 문제는 수학적으로 매우 복잡합니다. SVM은 이 문제를 풀기 위해 아주 영리한 스케일링 트릭을 사용합니다.

### 스케일링의 자유

초평면 $\mathbf{w}^T \mathbf{x} + w_0 = 0$ 과 $c(\mathbf{w}^T \mathbf{x} + w_0) = 0$ 은 기하학적으로 **완전히 동일한 평면**입니다. 즉, $\mathbf{w}$와 $w_0$의 크기를 조절할 자유가 있습니다.

### 함수 마진(Functional Margin)을 1로 고정

이 자유를 이용해, 우리는 **서포트 벡터에 대한 함수 마진 `y(wᵀx + w₀)`의 값을 정확히 1로 설정**하기로 '약속'합니다.

이것은 기하학적 관찰이 아니라, 문제를 풀기 위해 우리가 인위적으로 설정한 **편의를 위한 제약 조건**입니다.

### 스케일링의 결과

이 약속 하나로 모든 것이 간단해집니다.
1.  **마진 경계선**: $\mathbf{w}^T \mathbf{x} + w_0 = 1$ 과 $\mathbf{w}^T \mathbf{x} + w_0 = -1$ 이 됩니다.
2.  **전체 마진의 폭**: 두 경계선 사이의 거리인 **`2 / ||w||`** 가 됩니다.

---

## 4. 최종 최적화 문제

이제 SVM의 복잡했던 목표가 다음과 같은 깔끔한 최적화 문제로 바뀝니다.

-   **기존 목표**: 마진 `2 / ||w||`를 **최대화**하라.
-   **변환된 목표**: `||w||`를 **최소화**하라. (수학적 편의를 위해 `(1/2)||w||²`를 최소화)

그리고 모든 데이터는 마진 경계 바깥에 있어야 한다는 제약조건이 추가됩니다.

---

## 5. 요약: SVM은 어떻게 작동하는가?

1.  SVM의 목표는 두 클래스 사이의 **마진을 최대화**하는 최적의 결정 경계를 찾는 것이다.
2.  마진은 경계에 가장 가까운 **서포트 벡터**에 의해서만 결정된다.
3.  계산을 단순화하기 위해 서포트 벡터의 **함수 마진을 1로 고정**하는 스케일링 트릭을 사용한다.
4.  결과적으로 SVM 문제는 "**모든 데이터가 마진 경계(`±1`) 바깥에 있도록 유지하면서, 가중치 벡터의 크기 `||w||²`를 최소화하는**" 문제로 변환된다.
